# pcz

> **Warning**
> This project is in its 'move fast and break things' stage, **everything** is **EXPERIMENTAL**.

A reimagination of Go, using unmodified official toolchain (currently `go1.21`).

## Goals

- Be FFI friendly: unless it's a kernel, all useful programs works with FFI heavily (syscalls, C function calls as most systems are written in C).
- Provide platform native APIs: managing platform SDKs really sucks, do no more!
- Expand adoption of Go to...
  - GUI and Web Applications
  - Low-level system programming (think `crun`, `systemd`), EFI applications
  - Firmware and Kernel

## Non-Goals

- Change the way the Go team works or make them change their decisions.

## Components

- `std`: A custom Go standard library and runtime.

  > **NOTE**
  > This std module is meant to be compatible with the go toolchain (not the `go` command) by using `pcz`.

- `pcz`: A tool to build applications using custom std.
  - `pcz build` works like `go build` (invoking `go tool compile/asm/link/pack`) but with different options.
  - `pcz dev` provides easy development enironment setup.

  > **NOTE**
  > When running `pcz`, please make sure you are using `go1.21` toolchain, you can do this by setting environment variable `GOROOT` to the path to the toolchain home (if `pcz` wasn't built with local `go1.21` toolchain).

- `h2y`: A library to flatten AST.
  - generate YAML api specifications from C/Objective-C header files and WebIDL files (using `llvm` and `webidl2.js`).

- `ffigen`: A library to create go packages from YAML specifications generated by `h2y`.

## Installation

1. Install `go1.21` toolchain to your working machine
   - If you don't have any go toolchain installed, please refer to the [official Go installation doc](https://go.dev/doc/install) for guidance.
   - Otherwise, you can download and install it by running `go install golang.org/dl/go1.21.0@latest` and `"$(go env GOPATH)/bin/go1.21.0" install`, then it's available as `"$(go env GOPATH)/bin/go1.21.0"`.

2. Install `pcz` from source code like most other cli tools written in Go.

  ```bash
  # NOTE: The build tag `bindgen` adds js bindgen support
  go install -tags bindgen github.com/primecitizens/pcz
  ```

## Usage

See [examples](./examples/)

## Runtime Features

> **NOTE**
> Currently our major focus is on providing support for platfrom natvie apis, thus all Go language features except those doesn't require runtime support (e.g. control flow, type definitions and function calls) are missing, this is mainly because most runtime features require allocation, thus depends on platform apis we are working on (see [ROADMAP.md](https://github.com/primecitizens/pcz/blob/master/ROADMAP.md) for more details).

- [ ] `append`
- [ ] `make`
- [ ] `new`
- [ ] `go`
- [ ] `defer`
- [ ] `panic`
- [ ] `recover`
- [ ] `map`
- [ ] `delete`
- [ ] `chan`
- [ ] `close`
- [ ] `select`
- [ ] type switch (`switch x.(type)`)
- [ ] type assertions (`y, ok := x.(T)`)
- [ ] `clear`
- [x] `min`, `max` (compiler intrinsic)

## Credits

This project won't be possible without the excellent work done by the Go team, if it was not the Go programming language, we could never find love in programming, let alone this project.

We would also like to thank everyone adopting Go to make programming in general more accessible to laypeople/peasants like us, your splendid resources really helped us to improve our understandings and skills.

## LICENSE

```txt
Copyright 2023 The Prime Citizens

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

   http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
```
